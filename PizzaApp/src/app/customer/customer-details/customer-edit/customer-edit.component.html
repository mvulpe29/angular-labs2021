<div class="card">
  <div class="card-content">
    <form [formGroup]="customerFormGroup" (ngSubmit)="onSubmit()">
      <div class="row">
        <div class="col-12 col-md-3">
          <mat-form-field>
            <mat-label>First name</mat-label>
            <input matInput formControlName="firstName"/>
            <mat-error
              *ngIf="customerFormGroup.get('firstName')?.invalid && (customerFormGroup.get('firstName')?.dirty || customerFormGroup.get('firstName')?.touched)">
              <span *ngIf="customerFormGroup.get('firstName')?.errors?.['required']">First name required</span>
            </mat-error>
          </mat-form-field>
        </div>

        <div class="col-12 col-md-3">
          <mat-form-field>
            <mat-label>Last name</mat-label>
            <input matInput formControlName="lastName"/>
            <mat-error
              *ngIf="customerFormGroup.get('lastName')?.invalid && (customerFormGroup.get('lastName')?.dirty || customerFormGroup.get('lastName')?.touched)">
              <span *ngIf="customerFormGroup.get('lastName')?.errors?.['required']">Last name required</span>
            </mat-error>
          </mat-form-field>
        </div>


        <div class="col-12 col-md-3">
          <mat-form-field>
            <mat-label>Email</mat-label>
            <input matInput type="email" [formControl]="emailFormControl"/>

            <mat-error
              *ngIf="emailFormControl.invalid && (emailFormControl.dirty || emailFormControl.touched)">
              <span *ngIf="emailFormControl.errors && emailFormControl.errors['required']">Email required</span>
              <span *ngIf="emailFormControl.errors && emailFormControl.errors['email']">Email not valid</span>
              <span *ngIf="emailFormControl.errors && emailFormControl.errors['uniqueEmail']">Email taken</span>
              <span *ngIf="emailFormControl.errors && !emailFormControl.errors['email'] && emailFormControl.errors['forbiddenEmail']">Email forbidden</span>
            </mat-error>
          </mat-form-field>
        </div>

        <div class="col-12 col-md-3">
          <mat-form-field>
            <mat-label>Phone</mat-label>
            <input matInput formControlName="phone"/>
          </mat-form-field>
        </div>
      </div>

      <h6>Address</h6>

      <ng-container formGroupName="address">
        <div class="row">
          <div class="col-12 col-md-3">
            <mat-form-field>
              <mat-label>Street</mat-label>
              <input matInput formControlName="street"/>
            </mat-form-field>
          </div>
          <div class="col-12 col-md-3">
            <mat-form-field>
              <mat-label>City</mat-label>
              <input matInput
                     formControlName="city"
                     type="text"
                     [matAutocomplete]="cityAutocomplete"/>
              <mat-autocomplete autoActiveFirstOption #cityAutocomplete="matAutocomplete">
                <mat-option *ngFor="let option of filteredCities$ | async" [value]="option">
                  {{option}}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
          </div>
          <div class="col-12 col-md-3">
            <mat-form-field>
              <mat-label>Zip Code</mat-label>
              <input matInput formControlName="zipCode"/>
            </mat-form-field>
          </div>
          <div class="col-12 col-md-3">
            <mat-form-field>
              <mat-label>Country</mat-label>
              <mat-select formControlName="country">
                <mat-option *ngFor="let country of countries" [value]="country.code">
                  {{country.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
      </ng-container>

      <div class="d-flex justify-content-end">
        <button mat-raised-button
                color="primary"
                type="submit"
                [disabled]="customerFormGroup.invalid">
          Save
        </button>
      </div>
    </form>

    <div class="row">
      <div class="col-12 col-md-6">
        <p>Initial value</p>
        <code>
          <pre>{{customer | json}}</pre>
        </code>
      </div>
      <div class="col-12 col-md-6">
        <p>Form value</p>
        <code>
          <pre>{{customerFormGroup.value | json}}</pre>
        </code>
      </div>
    </div>

  </div>
</div>
